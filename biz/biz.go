package biz

import (
	"github.com/ngocchien/presearch-tool/constant"
	"github.com/ngocchien/presearch-tool/curl"
	"github.com/ngocchien/presearch-tool/master"
	log "github.com/sirupsen/logrus"
	"math/rand"
	"net/http"
	"strings"
	"sync"
	"time"
)

type biz struct {
	master *master.Master
}

var text = "Anyone whether they run a Bitcoin node or not can see these transactions occurring in real time To achieve a nefarious act a bad actor would need to operate 51% of the computing power that makes up Bitcoin Bitcoin has around 12809 full nodes as of early November 2021 and this number is growing making such an attack quite unlikely3 But if an attack were to happen Bitcoin miners the people who take part in the Bitcoin network with their computers would likely split off to a new blockchain making the effort the bad actor put forth to achieve the attack a waste Balances of Bitcoin tokens are kept using public and private keys which are long strings of numbers and letters linked through the mathematical encryption algorithm that creates them The public key comparable to a bank account number) serves as the address published to the world and to which others may send Bitcoin The private key comparable to an ATM PIN) is meant to be a guarded secret and only used to authorize Bitcoin transmissions Bitcoin keys should not be confused with a Bitcoin wallet which is a physical or digital device that facilitates the trading of bitcoin and allows users to track ownership of coins The term wallet is a bit misleading because Bitcoins decentralized nature means it is never stored in a wallet but rather distributed on a blockchain PeertoPeer Technology Bitcoin is one of the first digital currencies to use peertopeer P2P) technology to facilitate instant payments The independent individuals and companies who own the governing computing power and participate in the Bitcoin network Bitcoin miners are in charge of processing the transactions on the blockchain and are motivated by rewards the release of new Bitcoin) and transaction fees paid in Bitcoin These miners can be thought of as the decentralized authority enforcing the credibility of the Bitcoin network New bitcoins are released to miners at a fixed but periodically declining rate There are only 21 million bitcoins that can be mined in total As of November 2021 there are over 18865 million Bitcoin in existence and less than 2135 million Bitcoin left to mine4 In this way Bitcoin and other cryptocurrencies operate differently from fiat currency; in centralized banking systems the currency is created at a rate matching the growth of the economy; this system is intended to maintain price stability A decentralized system like Bitcoin sets the release rate ahead of time and according to an algorithm Bitcoin Mining Bitcoin mining is the process by which Bitcoin is released into circulation Generally mining requires solving computationally difficult puzzles to discover a new block which is added to the blockchain Bitcoin mining adds and verifies transaction records across the network Miners are rewarded with some Bitcoin; the reward is halved every 210000 blocks The block reward was 50 new bitcoins in 2009 On May 11 2020 the third halving occurred bringing the reward for each block discovery down to 625 bitcoins5 A variety of hardware can be used to mine Bitcoin However some yield higher rewards than others Certain computer chips called applicationspecific integrated circuits ASICs) and more advanced processing units such as graphic processing units GPUs) can achieve more rewards These elaborate mining processors are known as mining rigs One bitcoin is divisible to eight decimal places 100 millionths of one bitcoin) and this smallest unit is referred to as a Satoshi6 If necessary and if the participating miners accept the change Bitcoin could eventually be made divisible to even more decimal places Early Timeline of Bitcoin Aug 18 2008 The domain name Bitcoinorg is registered7 Today at least this domain is WhoisGuard Protected meaning the identity of the person who registered it is not public information Oct 31 2008 A person or group using the name Satoshi Nakamoto makes an announcement to the Cryptography Mailing List at metzdowdcom: Ive been working on a new electronic cash system thats fully peertopeer with no trusted third party This nowfamous white paper published on Bitcoinorg entitled Bitcoin: A PeertoPeer Electronic Cash System would become the Magna Carta for how Bitcoin operates today1 Jan 3 2009 The first Bitcoin block is mined Block 0 This is also known as the genesis block and contains the text: The Times 03/Jan/2009 Chancellor on brink of second bailout for banks perhaps as proof that the block was mined on or after that date and perhaps also as relevant political commentary8 Jan 8 2009 The first version of the Bitcoin software is announced to the Cryptography Mailing List Jan 9 2009 Block 1 is mined and Bitcoin mining commences in earnest Who Is Satoshi Nakamoto No one knows who invented Bitcoin or at least not conclusively Satoshi Nakamoto is the name associated with the person or group of people who released the original Bitcoin white paper in 2008 and worked on the original Bitcoin software that was released in 20091 In the years since then many individuals have either claimed to be or been rumored to be the reallife people behind the pseudonym but as of November 2021 the true identity or identities) of Satoshi Nakamoto remains obscured Although it is tempting to believe the medias spin that Satoshi Nakamoto is a solitary quixotic genius who created Bitcoin out of thin air such innovations do not typically happen in a vacuum All major scientific discoveries no matter how seemingly original were built on previously existing research There are precursors to Bitcoin: Adam Back s Hashcash invented in 1997 and subsequently Wei Dai s bmoney Nick Szabo s bit gold and Hal Finney s Reusable Proof of Work The Bitcoin white paper itself makes reference to Hashcash and bmoney as well as various other works spanning several research fields Perhaps unsurprisingly many of the individuals behind the other projects named above have been speculated to have also had a hand in creating Bitcoin There are a few possible motivations for Bitcoins inventor to keep their identity secret One is privacy: As Bitcoin has gained in popularity becoming something of a worldwide phenomenon Satoshi Nakamoto would likely garner a lot of attention from the media and from governments Another reason could be the potential for Bitcoin to cause a major disruption in the current banking and monetary systems If Bitcoin were to gain mass adoption the system could surpass nations sovereign fiat currencies This threat to existing currency could motivate governments to want to take legal action against Bitcoins creator The other reason is safety Looking at 2009 alone 32490 blocks were mined; at the reward rate of 50 Bitcoin per block the total payout in 2009 was 1624500 Bitcoin One may conclude that only Satoshi and perhaps a few other people were mining through 2009 and that they possess a majority of that stash of Bitcoin Someone in possession of that much Bitcoin could become a target of criminals especially considering that Bitcoin is less like stocks and more like cash wherein the private keys needed to authorize spending could be printed out and literally kept under a mattress Though its likely the inventor of Bitcoin would take precautions to make any extortioninduced transfers traceable remaining anonymous is a good way for Satoshi Nakamoto to limit exposure Special Considerations Bitcoin as a form of payment Bitcoin can be accepted as a means of payment for products sold or services provided Brickandmortar stores can display a sign saying “Bitcoin Accepted Here”; the transactions can be handled with the requisite hardware terminal or wallet address through QR codes and touchscreen apps An online business can easily accept Bitcoin by adding this payment option to its other online payment options: credit cards PayPal etc El Salvador became the first country to officially adopt Bitcoin as legal tender in June 20219 Bitcoin employment opportunities Those who are selfemployed can get paid for a job related to Bitcoin There are several ways to achieve this such as creating any internet service and adding your Bitcoin wallet address to the site as a form of payment There are also several websites and job boards that are dedicated to digital currencies: Jobs4Bitcoins is part of Redditcom BitGigs describes itself as a Bitcoin job board Bitwage offers a way to choose a percentage of your work paycheck to be converted into Bitcoin and sent to your Bitcoin address Investing in Bitcoin How to Buy Bitcoin Many Bitcoin supporters believe that digital currency is the future Many individuals who endorse Bitcoin believe it facilitates a much faster lowfee payment system for transactions across the globe Although it is not backed by any government or central bank Bitcoin can be exchanged for traditional currencies; in fact its exchange rate against the dollar attracts potential investors and traders interested in currency plays Indeed one of the primary reasons for the growth of digital currencies like Bitcoin is that they can act as an alternative to national fiat money and traditional commodities like gold In March 2014 the IRS stated that all virtual currencies including Bitcoin would be taxed as property rather than currency Gains or losses from Bitcoin held as capital will be realized as capital gains or losses while Bitcoin held as inventory will incur ordinary gains or losses The sale of Bitcoin you mined or purchased from another party or the use of Bitcoin to pay for goods or services are examples of transactions that can be taxed10 Like any other asset the principle of buying low and selling high applies to Bitcoin The most popular way of amassing the currency is through buying on a Bitcoin exchange but there are many other ways to earn and own Bitcoin Risks Associated With Bitcoin Investing Speculative investors have been drawn to Bitcoin after its rapid price appreciation in recent years Bitcoin had a price of $716752 on Dec 31 2019 and a year later had appreciated more than 300% to $2898498 It continued to surge in the first half of 2021 trading at a record high of over $68000 in November 202111 Thus many people purchase Bitcoin for its investment value rather than its ability to act as a medium of exchange However the lack of guaranteed value and its digital nature mean its purchase and use carry several inherent risks Many investor alerts have been issued by the Securities and Exchange Commission SEC) the Financial Industry Regulatory Authority FINRA) the Consumer Financial Protection Bureau CFPB) and other agencies The concept of a virtual currency is still novel and compared to traditional investments Bitcoin doesnt have much of a longterm track record or history of credibility to back it With its increasing popularity Bitcoin is becoming less experimental every day; still after only a decade all digital currencies remain in a development phase It is pretty much the highestrisk highestreturn investment that you can possibly make” says Barry Silbert CEO of Digital Currency Group which builds and invests in Bitcoin and blockchain companies12 Regulatory risk Investing money in any of Bitcoins many guises is not for the riskaverse Bitcoin is a rival to government currency and may be used for underground market transactions money laundering illegal activities or tax evasion As a result governments may seek to regulate restrict or ban the use and sale of Bitcoin and some already have) Others are coming up with various rules For example in 2015 the New York State Department of Financial Services finalized regulations that would require companies dealing with the buy sell transfer or storage of Bitcoin to record the identity of customers have a compliance officer and maintain capital reserves Any transactions worth $10000 or more will have to be recorded and reported13 The lack of uniform regulations about Bitcoin and other virtual currencies) raises questions over their longevity liquidity and universality Security risk Most individuals who own and use Bitcoin have not acquired their tokens through mining operations Rather they buy and sell Bitcoin and other digital currencies on any of the popular online markets known as Bitcoin exchanges or cryptocurrency exchanges Bitcoin exchanges are entirely digital and as with any virtual system are at risk from hackers malware and operational glitches If a thief gains access to a Bitcoin owners computer hard drive and steals their private encryption key they could transfer the stolen bitcoin to another account Users can prevent this only if their Bitcoin is stored on a computer that is not connected to the internet or else by choosing to use a paper wallet printing out the Bitcoin private keys and addresses and not keeping them on a computer at all) Hackers can also target Bitcoin exchanges gaining access to thousands of accounts and digital wallets where Bitcoin is stored One especially notorious hacking incident took place in 2014 when Mt Gox a Bitcoin exchange in Japan was forced to close down after millions of dollars worth of Bitcoin was stolen This is particularly problematic given that all Bitcoin transactions are permanent and irreversible Its like dealing with cash: Any transaction carried out with Bitcoin can only be reversed if the person who has received them refunds them There is no third party or payment processor as in the case of a debit or credit card hence no source of protection or appeal if there is a problem Insurance risk Some investments are insured through the Securities Investor Protection Corporation Normal bank accounts are insured through the Federal Deposit Insurance Corporation FDIC) up to a certain amount depending on the jurisdiction Generally speaking Bitcoin exchanges and Bitcoin accounts are not insured by any type of federal or government program In 2019 prime dealer and trading platform SFOX announced it would be able to provide Bitcoin investors with FDIC insurance but only for the portion of transactions involving cash14 Fraud risk Though Bitcoin uses private key encryption to verify owners and register transactions fraudsters and scammers may attempt to sell false Bitcoin For instance in July 2013 the SEC brought legal action against an operator of a Bitcoinrelated Ponzi scheme15 There have also been documented cases of Bitcoin price manipulation another common form of fraud Market risk As with any investment Bitcoin values can fluctuate Indeed the value of the currency has seen wild swings in price over its short existence Subject to high volume buying and selling on exchanges it has a high sensitivity to any newsworthy events According to the CFPB the price of Bitcoin fell by 61% in a single day in 2013 while the oneday price drop record in 2014 was as big as 80%16 If fewer people begin to accept Bitcoin as a currency these digital units may lose value and could become worthless Indeed there was speculation that the Bitcoin bubble had burst when the price declined from its alltime high during the cryptocurrency rush in late 2017 and early 2018 There is already plenty of competition and although Bitcoin has a huge lead over the hundreds of other digital currencies that have sprung up because of its brand recognition and venture capital money a technological breakthrough in the form of a better virtual coin is always a threat $68521 Bitcoins alltime high price reached on Nov 8 202111 Splits in the Cryptocurrency Community In the years since Bitcoin launched there have been numerous instances in which disagreements between factions of miners and developers prompted largescale splits of the cryptocurrency community In some of these cases groups of Bitcoin users and miners have changed the protocol of the Bitcoin network itself This process is known as forking and it usually results in the creation of a new type of Bitcoin with a new name This split can be a hard fork in which a new coin shares transaction history with Bitcoin up until a decisive split point at which point a new token is created Examples of cryptocurrencies that have been created as a result of hard forks include Bitcoin Cash created in August 2017) Bitcoin Gold created in October 2017) and Bitcoin SV created in November 2018) A soft fork is a change to the protocol that is still compatible with the previous system rules For example Bitcoin soft forks have added functionalities such as segregated witness SegWit) Why Is Bitcoin Valuable Bitcoins price has risen exponentially in just over a decade from less than $1 in 2011 to more than $68000 as of November 2021 Its value is derived from several sources including its relative scarcity market demand and marginal cost of production Thus even though it is intangible bitcoins command a high valuation with a total market cap of $117 trillion as of November 202111 Is Bitcoin a Scam Even though bitcoins are virtual and cant be touched they are certainly real Bitcoins have been around for more than a decade and the system has proved itself to be robust The computer code that runs the system moreover is open source and can be downloaded and analyzed by anybody for bugs or evidence of nefarious intent Of course fraudsters may attempt to swindle people out of their Bitcoin or hack sites such as crypto exchanges but these are flaws in human behavior or thirdparty applications and not in Bitcoin itself How Many Bitcoins Are There The maximum number of bitcoins that will ever be produced is 21 million and the last bitcoin will be mined at some point around the year 2140 As of November 2021 more than 1885 million almost 90%) of those bitcoins have been mined17 Moreover researchers estimate that up to 20% of those bitcoins have been lost due to people forgetting their private key dying without leaving any access instructions or sending bitcoins to unusable addresses18 Should I Capitalize the B in Bitcoin By convention use a capital B when discussing the Bitcoin network protocol or system Use a small b when talking about individual bitcoins as a unit of value for example I sent two bitcoins) Where Can I Buy Bitcoin There are several online exchanges that allow you to purchase Bitcoin In addition Bitcoin ATMs internetconnected kiosks that can be used to buy bitcoins with credit card or cash have been popping up around the world Or if you know a friend who owns some bitcoins they may be willing to sell them to you directly without any exchange at all SPONSORED Looking for a better way to buy crypto Buying crypto doesn t have to feel like a hassle If you ve been searching for a truly convenient and userfriendly place to buy Bitcoin Ethereum and more look no further than eToro Your capital is at risk Other fees apply For more information visit eToro Cryptoasset investing is unregulated in some EU countries and in the UK No consumer protection A cryptocurrency or “crypto”) is a digital currency that can be used to buy goods and services but uses an online ledger with strong cryptography to secure online transactions Much of the interest in these unregulated currencies is to trade for profit with speculators at times driving prices skyward The most popular cryptocurrency bitcoin has had volatile price moves this year reaching nearly $65000 in April before losing nearly half its value in May By midOctober the price had risen rapidly again: it hit an alltime high above $66000 before falling back slightly You can check the current price of bitcoin here) Here are seven things to ask about cryptocurrency and what to watch out for 1 What is cryptocurrency Cryptocurrency is a form of payment that can be exchanged online for goods and services Many companies have issued their own currencies often called tokens and these can be traded specifically for the good or service that the company provides Think of them as you would arcade tokens or casino chips You ll need to exchange real currency for the cryptocurrency to access the good or service Cryptocurrencies work using a technology called blockchain Blockchain is a decentralized technology spread across many computers that manages and records transactions Part of the appeal of this technology is its security Learn more: What is blockchain and how does it work Back to top 2 How many cryptocurrencies are there What are they worth More than 13000 different cryptocurrencies are traded publicly according to CoinMarketCapcom a market research website And cryptocurrencies continue to proliferate raising money through initial coin offerings or ICOs The total value of all cryptocurrencies on Oct 22 2021 was more than $25 trillion having fallen off an alltime high above $26 trillion days earlier The total value of all bitcoins the most popular digital currency was pegged at about $12 trillion Ready to invest Here are our picks for best bitcoin and cryptocurrency exchanges ADVERTISEMENT Coinbase Coinmama Gemini NerdWallet rating NerdWallet rating NerdWallet rating LEARN MORE LEARN MORE LEARN MORE FEES 05% 45% varies by type of transaction; other fees may apply FEES 286% 381% other fees may apply FEES 05% 399% depending on payment method and platform ACCOUNT MINIMUM $2 ACCOUNT MINIMUM $0 ACCOUNT MINIMUM $0 PROMOTION Earn $5 in bitcoin for getting started on Coinbase PROMOTION None no promotion available at this time PROMOTION $20 of BTC for new users after trading $100 or more within 30 days Best cryptocurrencies by market capitalization These are the 10 largest trading cryptocurrencies by market capitalization as tracked by CoinMarketCap a cryptocurrency data and analytics provider Cryptocurrency Market Capitalization Bitcoin $12 trillion Ethereum $5572 billion Binance Coin $1077 billion Solana $736 billion Tether $726 billion Cardano $674 billion XRP $585 billion Polkadot $521 billion Dogecoin $365 billion USD Coin $343 billion Data current as of Nov 8 2021 Learn more: How to invest in bitcoin Back to top 3 Why are cryptocurrencies so popular Cryptocurrencies appeal to their supporters for a variety of reasons Here are some of the most popular: Supporters see cryptocurrencies such as bitcoin as the currency of the future and are racing to buy them now presumably before they become more valuable Some supporters like the fact that cryptocurrency removes central banks from managing the money supply since over time these banks tend to reduce the value of money via inflation Other supporters like the technology behind cryptocurrencies the blockchain because it s a decentralized processing and recording system and can be more secure than traditional payment systems Some speculators like cryptocurrencies because they re going up in value and have no interest in the currencies  longterm acceptance as a way to move money Learn more: How to buy Ethereum Back to top 4 Are cryptocurrencies a good investment Cryptocurrencies may go up in value but many investors see them as mere speculations not real investments The reason Just like real currencies cryptocurrencies generate no cash flow so for you to profit someone has to pay more for the currency than you did That s what s called “the greater fool” theory of investment Contrast that to a wellmanaged business which increases its value over time by growing the profitability and cash flow of the operation “For those who see cryptocurrencies such as bitcoin as the currency of the future it should be noted that a currency needs stability” Some notable voices in the investment community have advised wouldbe investors to steer clear of them Of particular note legendary investor Warren Buffett compared bitcoin to paper checks: “Its a very effective way of transmitting money and you can do it anonymously and all that A check is a way of transmitting money too Are checks worth a whole lot of money Just because they can transmit money Learn more: Is bitcoin safe For those who see cryptocurrencies such as bitcoin as the currency of the future it should be noted that a currency needs stability so that merchants and consumers can determine what a fair price is for goods Bitcoin and other cryptocurrencies have been anything but stable through much of their history For example while bitcoin traded at close to $20000 in December 2017 its value then dropped to as low as about $3200 a year later By December 2020 it was trading at record levels again This price volatility creates a conundrum If bitcoins might be worth a lot more in the future people are less likely to spend and circulate them today making them less viable as a currency Why spend a bitcoin when it could be worth three times the value next year Back to top 5 How do I buy cryptocurrency While some cryptocurrencies including bitcoin are available for purchase with US dollars others require that you pay with bitcoins or another cryptocurrency To buy cryptocurrencies you ll need a “wallet” an online app that can hold your currency Generally you create an account on an exchange and then you can transfer real money to buy cryptocurrencies such as bitcoin or Ethereum Heres more on how to invest in bitcoin Coinbase is one popular cryptocurrency trading exchange where you can create both a wallet and buy and sell bitcoin and other cryptocurrencies Also a growing number of online brokers offer cryptocurrencies such as eToro Tradestation and Sofi Active Investing Robinhood offers free cryptocurrency trades Robinhood Crypto is available in most but not all US states) Learn more: Bitcoin wallet: How to choose the best for you Back to top 6 Are cryptocurrencies legal There s no question that they re legal in the United States though China has essentially banned their use and ultimately whether they re legal depends on each individual country Also be sure to consider how to protect yourself from fraudsters who see cryptocurrencies as an opportunity to bilk investors As always buyer beware Beyond bitcoin: What are altcoins and how do they work Back to top 7 How do I protect myself If you re looking to buy a cryptocurrency in an ICO read the fine print in the company s prospectus for this information: Who owns the company An identifiable and wellknown owner is a positive sign Are there other major investors who are investing in it It s a good sign if other wellknown investors want a piece of the currency Will you own a stake in the company or just currency or tokens This distinction is important Owning a stake means you get to participate in its earnings you re an owner) while buying tokens simply means youre entitled to use them like chips in a casino Is the currency already developed or is the company looking to raise money to develop it The further along the product the less risky it is It can take a lot of work to comb through a prospectus; the more detail it has the better your chances it s legitimate But even legitimacy doesn t mean the currency will succeed That s an entirely separate question and that requires a lot of market savvy But beyond those concerns just having cryptocurrency exposes you to the risk of theft as hackers try to penetrate the computer networks that maintain your assets One highprofile exchange declared bankruptcy in 2014 after hackers stole hundreds of millions of dollars in bitcoins Those aren t typical risks for investing in stocks and funds on major US exchanges Learn more: What is bitcoin Should you buy cryptocurrency Cryptocurrency is an incredibly speculative and volatile buy Stock trading of established companies is generally less risky than investing in cryptocurrencies such as bitcoin Back to top What online brokers offer cryptocurrencies Of the online brokerages and cryptocurrency exchanges that NerdWallet reviews the following currently offer cryptocurrencies Available for: Learn more BinanceUS Access to buy and sell nearly 60 cryptocurrencies Read review Coinbase Access to buy and sell nearly 100 cryptocurrencies Read review eToro Trading platform with access to 17 cryptocurrencies Read review Gemini Ability to buy and sell more than 50 cryptocurrencies Read review Robinhood Seven cryptocurrencies including bitcoin bitcoin cash and ethereum Read review SoFi Active Investing Offers more than 20 cryptocurrencies for trading including bitcoin ethereum and litecoin Read review TradeStation Offers trading for five cryptocurrencies including bitcoin bitcoin cash and ethereum Read review Webull Offers 10 cryptocurrencies for trading including bitcoin bitcoin cash ethereum and litecoin Read review Kraken Offers more than 90 cryptocurrencies Read review Disclosure: The author held no positions in the aforementioned securities at the original time of publication About the authors: James F Royal PhD is a former NerdWallet writer His work has also been featured in the Washington Post New York Times and the Associated Press Read more Kevin Voigt is a former investing writer for NerdWallet He has covered financial issues for more than 20 years including for The Wall Street Journal and CNNcom Read more"

func NewBiz(master *master.Master) *biz {
	return &biz{
		master: master,
	}
}

func randomKeyword() string {
	arrWord := strings.Split(text, " ")
	min := 2
	max := 20
	rand.Seed(time.Now().UTC().UnixNano())
	numWord := min + rand.Intn(max-min)
	totalWord := len(arrWord)

	var k []string
	for i := 0; i < numWord; i++ {
		num := rand.Intn(totalWord)
		k = append(k, arrWord[num])
	}
	return strings.Join(k, "+")
}

func (b biz) RunTask(task master.Task) bool {
	log.Infof("Run TaskId %v", task.DailyTaskId)
	log.Infof("AccountId %v", task.AccountId)
	userAgent := "Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1"
	Header := map[string]string{
		"authority":                 "engine.presearch.org",
		"sec-ch-ua":                 "\"Google Chrome\";v=\"95\", \"Chromium\";v=\"95\", \";Not A Brand\";v=\"99\"",
		"sec-ch-ua-mobile":          "?0",
		"sec-ch-ua-platform":        "\"macOS\"",
		"upgrade-insecure-requests": "1",
		"user-agent":                "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",
		"accept":                    "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
		"sec-fetch-site":            "same-origin",
		"sec-fetch-mode":            "navigate",
		"sec-fetch-user":            "?1",
		"sec-fetch-dest":            "document",
		"referer":                   "https://engine.presearch.org/search?q=galaxy+off",
		"accept-language":           "en-US,en;q=0.9,vi;q=0.8,de;q=0.7",
		"cookie":                    task.Cookie,
	}
	c := curl.NewCurl(userAgent)

	for i := 1; i < constant.MaxSearchByDay; i++ {
		log.Infof("AccountId %v numRun %v", task.AccountId, i)
		c.Execute(curl.Params{
			Url:     constant.UrlSearchEngine,
			Method:  http.MethodGet,
			Timeout: 10,
			Queries: map[string]interface{}{
				"q": randomKeyword(),
			},
			Headers: Header,
			Body:    nil,
		})
		time.Sleep(constant.SecondSleepBetweenSearch * time.Second)
	}
	res := b.master.UpdateTask(task.DailyTaskId, map[string]interface{}{
		"status": master.TaskStatusDone,
	})

	if !res {
		log.Infof("Update status process for accountId %v false", task.AccountId)
	}

	log.Infof("AccountId %v done task!", task.AccountId)
	return true
}

func (b biz) RunProcess() {
	log.Infof("IntervalRunProcess")
	log.Infof("MaxAccountConcurrent : %v", constant.MaxAccountConcurrent)
	log.Infof("MaxRetryGetTask : %v", constant.MaxRetryGetTask)
	log.Infof("SleepBetweenProcess : %vs", constant.SecondSleepBetweenProcess)
	log.Infof("SleepBetweenSearch : %vs", constant.SecondSleepBetweenSearch)

	i := 1
	numGetDataFalse := 1

	for {
		log.Infof("Run Process %v", i)
		tasks := b.master.GetTask(constant.MaxAccountConcurrent)
		if len(tasks) == 0 {
			numGetDataFalse += 1
		} else {
			numGetDataFalse = 1
			var wg sync.WaitGroup
			for _, task := range tasks {
				wg.Add(1)
				task := task
				go func() {
					defer wg.Done()
					b.RunTask(task)
				}()
			}
			wg.Wait()
		}

		log.Infof("Done Process %v", i)

		if numGetDataFalse == constant.MaxRetryGetTask {
			break
		}

		time.Sleep(constant.SecondSleepBetweenProcess * time.Second)

		i += 1
	}
}
